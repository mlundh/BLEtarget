/*
 * timers.c
 *
 *  Created on: May 25, 2024
 *      Author: mlundh
 *
 *      Timer2 is configured to count up as fast as possible. It is used to count the time between the
 *      back row of detectors and the first row of detectors to determine the speed of the pellet.
 *
 *      Timer 16 is configured to give an UPDATE event every millisecond. This is used as a timeout to determine when
 *      to collect data.
 *
 *
 *
 */




/**
 * ISR triggered when the
 *
 */
void timer16UpdateISR();

void timer2UpdateISR();



void timer16UpdateISR()
{
  LL_TIM_DisableCounter(TIM16);
  LL_TIM_DisableIT_UPDATE(TIM16);
  LL_TIM_ClearFlag_UPDATE(TIM16);

  HAL_GPIO_WritePin(LED_GPIO_Port, LED_Pin, GPIO_PIN_SET); // turn off the led

  interruptFlag = 1;

}
if(!LL_TIM_IsEnabledCounter(TIM16))
{
  LL_TIM_SetCounter(TIM16, 0);
  LL_TIM_EnableIT_UPDATE(TIM16);
  LL_TIM_EnableCounter(TIM16);

  HAL_GPIO_WritePin(LED_GPIO_Port, LED_Pin, GPIO_PIN_RESET); // turn on the led
}
